---
#
# Playbook to provision openstack instances
#

- name: Provision Openstack Instances
  hosts: localhost
  gather_facts: false
  vars_files:
    - ../group_vars/all.yml
    - ../group_vars/all.local.yml
    - ../group_vars/vault.yml
    - ../group_vars/vault.local.yml
    - ../group_vars/openstack/openstack.yml
    - ../group_vars/openstack/openstack.local.yml
  roles:
    - openstack_provision

- name: Configure Openstack Instances
  hosts:
    - os_unix_hosts
    - os_windows_hosts
  gather_facts: true
  vars:
    ansible_python_interpreter: '/usr/bin/python3'
  vars_files:
    - ../group_vars/all.yml
    - ../group_vars/all.local.yml
    - ../group_vars/vault.yml
    - ../group_vars/vault.local.yml
    - ../group_vars/openstack/openstack.yml
    - ../group_vars/openstack/openstack.local.yml
  roles:
    - role: openstack_configure
      become: True

- name: Messages to user
  hosts: localhost
  gather_facts: false
  tasks:
    - debug:
        msg: "MAKE SURE TO ADD THESE NEW VMS TO YOUR MACHINE's SSH CONFIG, HOSTS.LOCAL, AND/OR SSH-CONFIG.LOCAL"
